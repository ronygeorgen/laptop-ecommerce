{% extends 'base.html' %}
{% block content %}

<section class="section-conten padding-y bg">

    <div class="container">
        <div class="row">
            {% include 'includes/userdashboard_sidebar.html' %}
            <main class="col-md-9">
                <article class="card">
                    <header class="card-header">
                        <strong class="d-inline-block mr-3">Your order history</strong>
                    </header>
                    <div class="row"> 
                        <div class="col-md-12">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th class="text-center" scope="col">Order #</th>
                                        <th class="text-center" scope="col">Billing Name</th>
                                        <th class="text-center" scope="col">Order Items</th>
                                        <th class="text-center" scope="col">Total Quantity</th>
                                        <th class="text-center" scope="col">Order Total</th>
                                        <th class="text-center" scope="col">Date</th>
                                        <th class="text-center" scope="col">Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for order in orders %}
                                        {% ifchanged order.order.order_number %}
                                            <tr>
                                                <th class="text-center" scope="row"> {{order.order.order_number}} </th>
                                                <td class="text-center" scope="row">{{order.order.full_name}}</td>
                                                <td class="text-center" scope="row">
                                                    {% for item in orders|dictsort:'order.order_number' %}
                                                        {% if item.order.order_number == order.order.order_number %}
                                                            {{ item.product.product_name }} - ({{ item.quantity }}) <br>
                                                        {% endif %}
                                                    {% endfor %}
                                                </td>
                                                <td class="text-center" scope="row">{{ order.total_quantity }}</td>
                                                <td class="text-center" scope="row">â‚¹{{ order.order.order_total }}</td>
                                                <td class="text-center" scope="row">{{ order.order.created_at }}</td>
                                                <td class="text-center" scope="row"><a href="{% url 'my_orders_detailed_view' order_id=order.order.order_number pk=order.id %}" class="btn btn-primary">View Details</a></td>
                                             
                                              </tr>
                                        {% endifchanged %}
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div> <!-- row.// -->
                    <div class="table-responsive">
                    </div> <!-- table-responsive .end// -->
                </article> <!-- order-group.// --> 
            </main>
        </div> <!-- row.// -->
    </div>
</section>

{% endblock %}
