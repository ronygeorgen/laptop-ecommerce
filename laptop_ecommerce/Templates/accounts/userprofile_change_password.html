{% extends 'base.html' %}
{% block content %}

<section class="section-conten padding-y bg">

    <div class="container">
        <div class="row">
        {% include 'includes/userdashboard_sidebar.html' %}
        <main class="col-md-9">
            <article class="card">
              {% include 'includes/alerts.html' %}
            <header class="card-header">
                <strong class="d-inline-block mr-3">Change Your Password</strong>
            </header>
            <div class="card-body">
                <div class="row"> 
                    <div class="col-md-12">
                        <form action=" {% url 'userprofile_changePassword' %} " method="POST" onsubmit="return validateForm()">
                          {% csrf_token %}
                          
                          <div class="form-group">
                            <label for="">Current Password</label>
                            <input type="password" name="current_password" placeholder="Current password" class="form-control">
                          </div>
                          <div class="form-group">
                            <label for="">Create new password</label>
                            <input type="password" class="form-control" placeholder="Create new password" name="new_password" id="password" oninput="clearError('passwordError')">
                            <small id="passwordError" class="text-danger"></small>
                          </div>
                          <div class="form-group">
                            <label for="">Confirm password</label>
                            <input type="password" class="form-control" placeholder="Confirm Password" name="confirm_password" id="confirm_password" oninput="clearError('confirmPasswordError')">
                            <small id="confirmPasswordError" class="text-danger"></small>
                          </div>
                          <input type="submit" value="Submit" class="btn btn-primary">
                        </form>
                    </div>
                </div> <!-- row.// -->
            </div> <!-- card-body .// -->
            <div class="table-responsive">
            </div> <!-- table-responsive .end// -->
            </article> <!-- order-group.// --> 
        </main>
    </div> <!-- row.// -->
    </div>
    
    
    </section>

    <script>
      function validateForm() {
          // Reset error messages
          clearError('passwordError');
          clearError('confirmPasswordError');
  
          // Get input values
          var password = document.getElementById("password").value;
          var confirm_password = document.getElementById("confirm_password").value;
  
          // Regular expressions for validation
          var whitespaceRegex = /\s/;
          var dotRegex = /\./;
          var specialCharacterRegex = /[!@#$%^&*(),.?":{}|<>]/;
          var digitRegex = /\d/;
          var uppercaseRegex = /[A-Z]/;
          var lowercaseRegex = /[a-z]/;
  
          // Check for white spaces and dots
          if (whitespaceRegex.test(password) || dotRegex.test(password)) {
              showError('passwordError', "Password cannot contain white spaces or dots.");
              return false;
          }
  
          // Check for minimum 8 characters with special characters, digits, letters, and uppercase and lowercase letters
          if (password.length < 8 || !specialCharacterRegex.test(password) || !digitRegex.test(password) ||
              !uppercaseRegex.test(password) || !lowercaseRegex.test(password)) {
              showError('passwordError', "Password should have minimum 8 characters with special characters, digits, letters, and at least one uppercase and one lowercase letter.");
              return false;
          }
  
          // Check if passwords match
          if (password !== confirm_password) {
              showError('confirmPasswordError', "Passwords do not match.");
              return false;
          }
  
          // If all validations pass, submit the form
          return true;
      }
  
      function showError(elementId, errorMessage) {
          // Display error message below the input field
          document.getElementById(elementId).innerHTML = errorMessage;
      }
  
      function clearError(elementId) {
          // Clear error message
          document.getElementById(elementId).innerHTML = "";
      }
  </script>
    
{% endblock %}